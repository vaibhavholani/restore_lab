(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8017],{30137:function(e,t,n){"use strict";n.d(t,{b:function(){return O},t:function(){return ce}});var r=n(67294),o=n(12398),a=n(93101),i=n(69429),u=n(298),l=n(65455),c=n(49313),s=n(34937),d=(0,s.defineContents)("externalworkflowpage",{headerDefault:{id:"headerDefault",type:"string",placeholderContent:"If you've made your purchase, get started now. (PH)"},messageDefault:{id:"messageDefault",type:"string",placeholderContent:"Please complete the purchase in your web browser. If you would like to purchase later, you can cancel now. (PH)"},cancelButtonDefault:{id:"cancelButtonDefault",type:"string",placeholderContent:"Cancel (PH)"},continueButtonDefault:{id:"continueButtonDefault",type:"string",placeholderContent:"Get Started (PH)"},headerChangePlan:{id:"headerChangePlan",type:"string",placeholderContent:"Switch your plan in your Adobe Account. (PH)"},messageChangePlan:{id:"messageChangePlan",type:"string",placeholderContent:"Once you are done, come back here and click Continue to proceed. If you would like to continue later, you can cancel for now. (PH)"},cancelButtonChangePlan:{id:"cancelButtonChangePlan",type:"string",placeholderContent:"Cancel (PH)"},continueButtonChangePlan:{id:"continueButtonChangePlan",type:"string",placeholderContent:"Continue (PH)"}}),p=n(8703),f=n(54536),v=n(52253),y=n(30488),m=n(12510),g=n(52007),C=n(66482),T=n(36015),h=r.createElement,O=(0,C.c)("checkout/external",d.__contentType,d)((function(e){var t=e.workflow,n=(0,s.useContentEntry)(d),C=(0,y.useCommerceAppContext)().emitMessage,O=(0,g.useTrackEvent)();(0,r.useEffect)((function(){var e=(0,u.W6)("".concat(t).concat(v.ps.COMPLETE_PURCHASE_WEB,":").concat(v.ps.MODAL),"".concat(v.ps.COMPLETE_PURCHASE_WEB));O(e)}),[O,t]);var E=function(e){switch(e){case p.q.CHANGE_PLAN:return{header:n.get(d.headerChangePlan),message:n.get(d.messageChangePlan),cancelButton:n.get(d.cancelButtonChangePlan),continueButton:n.get(d.continueButtonChangePlan)};default:return{header:n.get(d.headerDefault),message:n.get(d.messageDefault),cancelButton:n.get(d.cancelButtonDefault),continueButton:n.get(d.continueButtonDefault)}}}(t),P=E.header,A=E.message,b=E.cancelButton,S=E.continueButton,_=(0,m.useStore)(),I=(0,l.jz)(_.getState());return h("div",{className:i.Z.container},!I&&h("div",{className:i.Z.closeContainer},h(o.default,{variant:"action",quiet:!0,onClick:function(){C(y.SystemMessage.CLOSE)},icon:h(a.default,{size:"L"}),"data-testid":"closeButton"})),h("div",{className:i.Z.center},h(f.f,{size:"L","data-testid":"externalWorkflowIcon"}),h(c.X6,null,P),h("p",{className:i.Z.message},A),h("div",{className:i.Z.buttonContainer},h(o.default,{variant:"secondary","data-testid":"externalWorkflowCancelButton",onClick:function(){var e=(0,u.W6)("".concat(t).concat(v.ps.COMPLETE_PURCHASE_WEB,":").concat(v.ps.CANCEL),"".concat(v.ps.COMPLETE_PURCHASE_WEB).concat(v.ps.CANCEL));O(e),C(y.SystemMessage.CLOSE)}},b),h(o.default,{variant:"cta","data-testid":"externalWorkflowContinueButton",onClick:function(){var e=(0,u.W6)("".concat(t).concat(v.ps.COMPLETE_PURCHASE_WEB,":").concat(v.ps.GET_STARTED),"".concat(v.ps.COMPLETE_PURCHASE_WEB).concat(v.ps.GET_STARTED));O(e),C(y.SystemMessage.CLOSE,{shouldTriggerLicenseCheck:!0,status:T.WorkflowStatus.ORDER_COMPLETE})}},S))))})),E=n(26075),P=n(45800),A=n(99246),b=n(27261),S=n(76410);function _(){var e=(0,b.Z)(["\n  query UserSubscriptionChangePlanQuery($offerId: ID!, $subscriptionId: ID!) {\n    user {\n      id\n      userSubscription(subscriptionId: $subscriptionId) {\n        id\n        changePlanAllowed(offerId: $offerId)\n      }\n    }\n  }\n"]);return _=function(){return e},e}function I(){var e=(0,b.Z)(["\n  fragment IneligiblePurchaseOrderFragment on Order {\n    marketSegment\n    country\n    cart {\n      cartItems {\n        offerId\n        conflicts {\n          offerId\n          reasonCode\n          subscriptionId\n        }\n      }\n    }\n  }\n"]);return I=function(){return e},e}function R(){var e=(0,b.Z)(["\n  query getOfferForIneligiblePurchaseQuery($offerId: ID!, $country: String!) {\n    offer(id: $offerId, country: $country) {\n      ...IneligiblePurchaseOfferFragment\n    }\n  }\n  ","\n"]);return R=function(){return e},e}function N(){var e=(0,b.Z)(["\n  fragment IneligiblePurchaseOfferFragment on Offer {\n    id\n    commitment\n    term\n    productArrangement {\n      cloud\n      family\n    }\n    offerContent {\n      productName\n      productIconUrls\n    }\n  }\n"]);return N=function(){return e},e}var w=(0,S.Ps)(N()),L=(0,S.Ps)(R(),w),k=(0,S.Ps)(I()),x=(0,S.Ps)(_()),D=function(e,t,n){return e.query({query:L,variables:{offerId:t,country:n}}).then((function(e){return e.data.offer}))},U=n(62482),F=n(36623),M=n(26265),Z=n(809),j=n.n(Z),B=n(92447),W=n(38347),Y=n(91229),H=n(85564),q=n.n(H),G=n(37244),V=n.n(G),K=n(7585),z=n(61792),$=n(73728),Q=n(61274),X=n(62452),J=n(85475),ee=r.createElement,te=function(e){return ee(K.a,null,(function(t){return ee(ne,(0,Y.Z)({client:t},e))}))},ne=function(e){var t,n=e.client,o=e.openUrl,a=e.onFooterClicked,i=(0,W.Z)(e,["client","openUrl","onFooterClicked"]),u=(0,J.w)(),c=(0,r.useContext)(m.StoreContext),s=(0,m.useStore)(),d=c.getState(),p=(0,l.n$)(d),f=(0,m.useSelector)(F.NO),v=(0,z.hP)(d),y=(0,z.et)(d),g=null===y||void 0===y?void 0:y.userId,C=(0,Q.d0)(),T=(0,X.tD)(),h=T.redirect,O=T.cancelUrl,E=null!==o&&void 0!==o?o:h,A=(0,X.Sd)(),b=n.readFragment({fragment:k,id:"Order:".concat(f),fragmentName:"IneligiblePurchaseOrderFragment"}),S=(0,r.useCallback)(function(){var e=(0,B.Z)(j().mark((function e(t,r){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(n,t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[n]),_=(0,r.useCallback)((function(e,t){return function(e,t,n,r){return e.query({query:x,variables:{offerId:t,subscriptionId:n},context:r,fetchPolicy:"network-only"}).then((function(e){var t=(e.data.user||{}).userSubscription;return null===t||void 0===t?void 0:t.changePlanAllowed})).catch((function(){return!1}))}(n,e,t,v?{headers:{authorization:v}}:{})}),[n,v]),I=(0,r.useCallback)(function(){var e=(0,B.Z)(j().mark((function e(t){var r,o;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,P.FG)(n,t,g,p);case 2:return r=e.sent,o=r.data,e.abrupt("return",{data:o});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n,p,g]),R=(0,r.useCallback)(function(){var e=(0,B.Z)(j().mark((function e(t){var n,r,o,a,i,l;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.info("Checking whether user is eligible for I2T upgrade in case of duplicate purchase"),e.next=3,I(t);case 3:if(i=e.sent,l=i.data,!((null===l||void 0===l||null===(n=l.individualToTeamUpgradeOffers)||void 0===n||null===(r=n.activeOffersResult)||void 0===r?void 0:r.filter((function(e){var t,n;return null===e||void 0===e||null===(t=e.offer)||void 0===t||null===(n=t.tags)||void 0===n?void 0:n.includes("ACTIVE_SUBSCRIPTION_I2T_UPGRADEABLE")}))).length>0&&(null===l||void 0===l||null===(o=l.individualToTeamUpgradeOffers)||void 0===o||null===(a=o.upgradeOffersResult)||void 0===a?void 0:a.offers.length)>0)){e.next=9;break}return u.info("Eligible for i2t upgrade as part of duplicate purchase from A.com"),e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[I,u]),N=function(e,t,n){var r,o=null===e||void 0===e||null===(r=e.productArrangement)||void 0===r?void 0:r.family,a=n.find((function(e){return(null===e||void 0===e?void 0:e.paFamily)===o}));return t.includes(null===a||void 0===a?void 0:a.id)},w=(0,r.useCallback)(function(){var e=(0,B.Z)(j().mark((function e(t){var n,r,o,a,i,l,c,s,d,f,v,y,m,g,C,T,h;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t);case 2:d=e.sent,f=d.data,v=null===f||void 0===f||null===(n=f.individualToTeamUpgradeOffers)||void 0===n?void 0:n.activeSubscriptions,y=null===f||void 0===f||null===(r=f.individualToTeamUpgradeOffers)||void 0===r||null===(o=r.activeOffersResult)||void 0===o?void 0:o.map((function(e){return{id:null===e||void 0===e?void 0:e.offer.id,paFamily:null===e||void 0===e?void 0:e.offer.productArrangement.family}})),m=null===f||void 0===f||null===(a=f.individualToTeamUpgradeOffers)||void 0===a||null===(i=a.upgradeOffersResult)||void 0===i?void 0:i.offers,g=null===b||void 0===b||null===(l=b.cart)||void 0===l||null===(c=l.cartItems)||void 0===c?void 0:c.map((function(e){var t;return null===e||void 0===e||null===(t=e.conflicts)||void 0===t?void 0:t.map((function(e){return e.offerId}))})),C=q()(g),T=null===m||void 0===m?void 0:m.map((function(e,t){var n=e.offer;if(t<v.length)return{id:n.id,q:N(n,C,y)?2:1}})).filter((function(e){return void 0!==e})),s={},(0,M.Z)(s,V().app.COUNTRY.name,t),(0,M.Z)(s,V().app.LANGUAGE.name,p),(0,M.Z)(s,V().app.CURRENT_SUBSCRIPTION_IDS.name,v),(0,M.Z)(s,V().app.ITEMS.name,T),h=s,u.info("Redirecting to i2t payment page as part of duplicate purchase from A.com"),A(h);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[I,A,p,b,u]),L=$.j$.IN_WEB,U=null===(t=s.getPersonalizedContentVariationByAEMQueryName)||void 0===t?void 0:t.call(s,"ineligible-purchase-dialogs-list"),Z=U?Object.fromEntries(U.split(";").map((function(e){return e.split("=")}))):void 0;return ee($.jO,(0,Y.Z)({fetchOffer:S,fetchUserSubscriptionChangeOfferAllowed:_,fetchIndividualToTeamUpgradeAllowed:R,upgradeIndividualToTeam:w,locale:"zh-hant"===p?"zh_TW":p,switchPlanSurface:L,order:b,openUrl:E,onFooterClicked:a,cancelUrl:O,promoCode:null===C||void 0===C?void 0:C[0],variation:Z},i))},re=n(56),oe=n(23424),ae=n(37703),ie=r.createElement;function ue(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return le(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw a}}}}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ce=function(e){var t=e.children,n=(0,E.x)(),o=(0,re.TZ)(),a=(0,y.useCommerceAppContext)().isInApp,i=(0,X.nV)(),u=(0,r.useState)(!1),l=u[0],c=u[1],s=(0,r.useState)(void 0),d=s[0],f=s[1],v=(0,ae.useSelector)(F.NO),m=(0,oe.g)([A.R.UC_REDIRECT_ROUTE]),g=(0,r.useCallback)((function(){var e,t,r=n.readFragment({fragment:k,id:"Order:".concat(v),fragmentName:"IneligiblePurchaseOrderFragment"}),o=ue(null===r||void 0===r||null===(e=r.cart)||void 0===e?void 0:e.cartItems);try{for(o.s();!(t=o.n()).done;){var a,i=ue(t.value.conflicts);try{for(i.s();!(a=i.n()).done;){var u=a.value;if(u.reasonCode)return u.reasonCode}}catch(l){i.e(l)}finally{i.f()}}}catch(l){o.e(l)}finally{o.f()}}),[v,n]);function C(e){switch(e){case P.rg.IneligibleSwitch:case P.rg.IneligibleIncluded:case P.rg.IneligibleDuplicateUpgrade:f(p.q.CHANGE_PLAN);break;default:f(void 0)}}return ie(r.Fragment,null,ie(te,{openUrl:a()?function(e){C(g()),c(!0);var t=(0,U.AK)(e,m[A.R.UC_REDIRECT_ROUTE]);i(t)}:void 0,onFooterClicked:a()?function(){C(void 0),c(!0)}:void 0,adobeLaunchAnalytics:o}),l?ie(O,{workflow:d}):t)}},29680:function(e,t,n){"use strict";n.d(t,{V:function(){return d},l:function(){return s}});var r=n(67294),o=n(3151),a=n(34937),i=(0,a.defineContents)("SupportBannerContent",{headline:{id:"headline",type:"string",placeholderContent:"Need to buy more? We can help. To buy more than 250 licenses, we recommend calling our Sales team at {salesPhoneNumber} or chatting with support for help"},ctaLabel:{id:"ctaLabel",type:"string",placeholderContent:"Start Chat"}}),u=n(8969),l=n(10315),c=r.createElement;function s(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,r.useState)(e),n=t[0],o=t[1];return{showBanner:n,setShowBanner:o}}var d=(0,l.n)("supportBannerQuantityExceed",i)((function(e){var t=e.ctaClicked,n=e.onClose,r=e.contentVariables,l=void 0===r?{}:r,s=(0,a.useContentEntry)(i),d=s.format(i.headline,l),p=s.get(i.ctaLabel);return c("div",{"data-testid":"support-banner",id:o.Z.bannerContainer},c(u.Toast,{actionLabel:p,closable:!0,onAction:t,onClose:n},d))}))},46576:function(e,t,n){"use strict";n.d(t,{mw:function(){return g},Vk:function(){return O}});var r=n(809),o=n.n(r),a=n(92447),i=n(27261),u=n(76410),l=n(26075),c=n(36623),s=n(61792),d=n(65455),p=n(62452),f=n(37703),v=n(67294),y=n(12510);function m(){var e=(0,i.Z)(["\n  query GET_COUNTRY_CHANGE_ALLOWED {\n    user {\n      id\n      countryChangeAllowed\n    }\n  }\n"]);return m=function(){return e},e}var g="GET_COUNTRY_CHANGE_ALLOWED",C=(0,u.Ps)(m());function T(e,t){return h.apply(this,arguments)}function h(){return(h=(0,a.Z)(o().mark((function e(t,n){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!1,e.prev=1,!n){e.next=7;break}return e.next=5,t.query({query:C,context:{headers:{Authorization:"Bearer ".concat(n)}},fetchPolicy:"no-cache"});case 5:a=e.sent,r=a.data.user.countryChangeAllowed;case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}var O=function(){var e=(0,f.useDispatch)(),t=(0,p.KW)(),n=(0,y.useStore)().getState(),r=(0,s.PQ)(n),i=(0,d.mT)(n),u=(0,s.et)(n).countryCode,m=(0,s.hP)(n),g=(0,c.qr)(n),C=(0,l.x)();(0,v.useEffect)((function(){function n(){return(n=(0,a.Z)(o().mark((function n(){var r,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=!0,a=u&&u!==i,n.t0=!g,!n.t0){n.next=7;break}return n.next=6,T(C,m);case 6:n.t0=n.sent;case 7:r=n.t0,a&&!r&&t(u),e((0,s.oY)(r));case 10:case"end":return n.stop()}}),n)})))).apply(this,arguments)}r&&function(){n.apply(this,arguments)}()}),[])}},6804:function(e,t,n){"use strict";n.d(t,{Ux:function(){return p},kg:function(){return d}});n(55988);var r=n(73864),o=["Accordion","AccordionItem","Button","ButtonGroup","Card","CardBody","Dropdown","Overlay","OverlayTrigger","Portal","Provider","Search","Select","Selector","Slider","SwitchBase"],a=!1,i=["findDOMNode"],u=n(4497),l=n(19291),c={name:r.APP_NAME,level:u.zq.INFO,remote:!0,remoteUrl:r.APP_LOG_ENDPOINT,method:"POST",flushInterval:500},s=/((Script error)|webkitExitFullScreen)/i;var d=(0,u.YR)(c);function p(){(0,l.Lf)()&&(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=/strict(-| )?mode/gi,r=/Unexpected key "\w+" found in previous state received by the reducer/,u=e.error;e.error=function(l){for(var c,s,d=arguments.length,p=new Array(d>1?d-1:0),f=1;f<d;f++)p[f-1]=arguments[f];if(null!==l&&void 0!==l&&null!==(c=l.match)&&void 0!==c&&c.call(l,r)){if(!a)return a=!0,void(t&&e.warn('Suppressing "Unexpected key found warning from Redux, due to Pandora slice injection"'));if(a)return}if(null!==l&&void 0!==l&&null!==(s=l.match)&&void 0!==s&&s.call(l,n)){var v,y=(null===p||void 0===p||null===(v=p[0])||void 0===v?void 0:v.split(",").map((function(e){return e.trim()})))||[];if(y.length&&!y.filter((function(e){return!o.includes(e)})).length)return;if(i.includes(p[0])&&o.includes(null===p||void 0===p?void 0:p.find((function(e){return e!==p[0]}))))return}u.call.apply(u,[e,l].concat(p))},t&&e.warn("Workaround: Ignoring React strict-mode errors originating from spectrum v2 components. Components: ".concat(o.join(", "),". Methods: ").concat(i.join(", "),"."))}(console,!0),function(e){var t=e.onerror;e.onerror=function(e,n,r,o,a){return s.test(e)||d.error({src:n,ln:r,col:o,error:a,label:"uncaught_error"},e),"function"!==typeof t||t(e,n,r,o,a)}}(window))}},47130:function(e,t,n){"use strict";n.d(t,{Z:function(){return f},G:function(){return v}});var r=n(34828),o=n.n(r),a=n(8777),i=n.n(a),u=n(87835),l=n(19291),c=n(49675),s=n(34155),d={keepAlive:!0,timeout:c.L.SOCKET_TIMEOUT};s.env.APP_ENV===u.T.LOCAL&&(d.rejectUnauthorized=!1);var p=(0,l.Lf)()?void 0:new(i().Agent)(d);function f(){return p}function v(){return new(o().Agent)(d)}},94945:function(e,t,n){"use strict";n.d(t,{p:function(){return v},M:function(){return y}});var r=n(26265),o=n(41609),a=n.n(o),i=n(37244),u=n.n(i),l=n(96029),c=n(19291),s=n(2385),d=n(62482);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){var r,o;if(t){for(var a=n||{},i=a.promotionTerm,u=void 0===i?"":i,l=a.promotionTermValue,c=void 0===l?"":l,d=(null===u||void 0===u?void 0:u.toLowerCase())||"",p=(null===c||void 0===c?void 0:c.toString())||"",f=t.toLowerCase(),v=0;v<(null===e||void 0===e?void 0:e.length);v++){var y=e[v],m=y.offerType,g=y.trialTerm,C=y.trialTermUnit;if(f===String(m).toLowerCase())if(t===s.m_.Trial){if(String(C).toLowerCase()===d){if(g===p){r=y;break}g||(o=y)}}else o=y}return r||o}}function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!a()(t)){var i=(0,l.vl)(e.store.getState()),s=i[u().app.ITEMS.name].map((function(e,n){return f(f({},e),{},{id:t[n]})})),p=i[u().app.ITEMS.name].length;if((0,c.Lf)()){var v=f(f({},i),{},(0,r.Z)({},u().app.ITEMS.name,s));o&&(v=f(f({},v),{},(0,r.Z)({},u().app.ORIGINAL_OFFER_ID.name,t[p]))),n&&(v=f(f({},v),{},(0,r.Z)({},u().app.RECOMMENDATION_REQUEST_ITEMS.name,s))),e.store.dispatch((0,l.BT)(v))}else{e.req.query[u().app.ITEMS.name]=s,n&&(e.req.query[u().app.RECOMMENDATION_REQUEST_ITEMS.name]=s),o&&(e.req.query[u().app.ORIGINAL_OFFER_ID.name]=t[p]),e.store.dispatch((0,l.BT)(e.req.query));var y=(0,d.tW)(e.req.query),m="".concat(e.req.url.split("?")[0]);e.req.url="".concat(m,"?").concat(y)}}}},7853:function(e,t,n){"use strict";n.d(t,{A:function(){return u},t:function(){return l}});var r=n(27261),o=n(76410);function a(){var e=(0,r.Z)(["\n  mutation UPDATE_PAYPAL_TRANSACTION(\n    $token: String!\n    $status: PayPalTransactionStatus!\n  ) {\n    updatePayPalTransaction(token: $token, status: $status)\n  }\n"]);return a=function(){return e},e}function i(){var e=(0,r.Z)(["\n  query GET_PAYPAL_STATUS($token: String!) {\n    paypalTransaction(token: $token) {\n      status\n    }\n  }\n"]);return i=function(){return e},e}var u=(0,o.Ps)(i()),l=(0,o.Ps)(a())},58886:function(e,t,n){"use strict";n.d(t,{C:function(){return c}});var r=n(809),o=n.n(r),a=n(92447),i=n(61792),u=n(75295),l=n(19291);function c(e,t){return s.apply(this,arguments)}function s(){return(s=(0,a.Z)(o().mark((function e(t,n){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,i.PQ)(t)){e.next=5;break}r=(0,i.hP)(t),e.next=9;break;case 5:if((0,l.Lf)()){e.next=9;break}return e.next=8,(0,u.Y)({},n);case 8:r=e.sent;case 9:return a=r?{headers:{authorization:"Bearer ".concat(r)}}:{},e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},9777:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Xn}});var r=n(809),o=n.n(r),a=n(32292),i=n(26265),u=n(92447),l=n(67294),c=n(37244),s=n.n(c),d=n(99246),p=n(31549),f=n(1342),v=n(14834),y=n(37361),m=n(26075),g=n(3490),C=n(7967),T=n(42861),h=n(54147),O=n(33670),E=n(36623),P=n(97094),A=n(1025),b=n(23996),S=n(91229),_=n(48290),I=n(784),R=n(27261),N=n(76410);function w(){var e=(0,R.Z)(["\n  fragment CompanyInfoFragment on ChangePlan {\n    id\n    billingContact {\n      companyName\n      companyPhone\n    }\n  }\n"]);return w=function(){return e},e}var L=(0,N.Ps)(w()),k=n(80519);function x(){return{type:k.NI.FORM,code:"COMPANYINFO:FORM_NON_FATAL_ERROR",extensions:{silent:!0}}}var D=n(65455),U=n(29550),F=n(37703),M=n(10315),Z=l.createElement,j=(0,M.n)("companyInfoForm",I.sY)((function(e){var t,n,r=e.companyInfoRef,o=e.companyName,a=e.disableCompanyName,i=e.marketSegment,u=e.submitCallback,l=(0,m.x)(),c=(0,F.useSelector)(D.mT),s=(0,F.useSelector)(E.NO),d=(0,F.useSelector)(_.n);(0,U.pS)(d,x,!1);var p,f,v=l.readFragment({id:"ChangePlan:".concat(s),fragment:L}),y=(0,I.q$)(_.Q).state,g=(null===y||void 0===y||null===(t=y.businessPhone)||void 0===t?void 0:t.value)||(null===v||void 0===v||null===(n=v.billingContact)||void 0===n?void 0:n.companyPhone)||"";o||(o=(null===y||void 0===y||null===(p=y.companyName)||void 0===p?void 0:p.value)||(null===v||void 0===v||null===(f=v.billingContact)||void 0===f?void 0:f.companyName)||"");var C={storeSliceName:_.Q,businessPhone:g,companyName:o,country:c,disableCompanyName:a,marketSegment:i,submitCallback:u};return Z(I.ax,(0,S.Z)({ref:r},C))})),B=n(34937),W=n(20534),Y=n(33580),H=n(45633),q=n(37629),G=n(11057),V=n(52253),K=n(3853),z=n(38712),$=(0,B.defineContents)("ExistingPlanTerm",{description:{id:"description",type:z.RichTextContent.JSON}}),Q=(0,B.defineContents)("ExistingPlanTermOption",{refundCount:{id:"refundCount",type:"string"},terms:{id:"terms",type:$,isArray:!0}}),X=(0,B.defineContents)("ExistingPlan",{title:{id:"title",type:"string",placeholderContent:"Your existing plan and content"},learnMoreText:{id:"learnMoreText",type:"string",placeholderContent:"Learn more"},learnMoreLink:{id:"learnMoreLink",type:"string",placeholderContent:"https://helpx.adobe.com/enterprise/using/individuals-to-teams-plan-upgrade.html"},allTerms:{id:"allTerms",type:Q,isArray:!0,placeholderContent:[{refundCount:"0",terms:[{description:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"Your new team subscription starts immediately."}]}]}},{description:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"All the content currently in your Adobe cloud storage will be moved and available in your team plan. "}]}]}}]},{terms:[{description:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"Your new teams subscription starts immediately, and you\u2019ll receive a "},{nodeType:"text",value:"{refundCount, plural, \n                        =1 {{refund1} refund }\n                        other {{refund1} refund and  {refund2} refund }\n                      }",format:{variants:["bold"]}},{nodeType:"text",value:"in 3-5 business days for your canceled individual {plansCount, plural, =1 {subscription} other {subscriptions}}."}]}]}},{description:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"All the content currently in your Adobe cloud storage will be moved and available in your team plan. "}]}]}}]}]},newAllTerms:{id:"newAllTerms",type:Q,isArray:!0,placeholderContent:[{refundCount:"0",terms:[{description:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"Your new {commitmentTerm, select, MONTH {monthly} YEAR {yearly} other {}} team subscription starts immediately."}]}]}},{description:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"All the content currently in your Adobe cloud storage will be moved and available in your team plan. "}]}]}}]},{terms:[{description:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"Your new {commitmentTerm, select, MONTH {monthly} YEAR {yearly} other {}} team subscription starts immediately."}]}]}},{description:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"You\u2019ll get a "},{nodeType:"text",value:"{refundCount, plural, \n                        =1 {{refund1} refund }\n                        other {{refund1} refund and  {refund2} refund }\n                      }",format:{variants:["bold"]}},{nodeType:"text",value:"in 3-5 business days for your canceled {plansCount, plural, =1 {{cancellingProductName} subscription} other {individual subscriptions}}."}]}]}},{description:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"All the content currently in your Adobe cloud storage will be moved and available in your team plan. "}]}]}}]}]}}),J=n(45800),ee=n(61792),te=n(62482),ne=n(97039),re=n(5764),oe=n(12510),ae=l.createElement;function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var le=(0,M.n)("existingPlanDetails",X)((function(e){var t=e.refundAmount,n=e.existingPlansCount,r=(0,oe.useStore)().getState(),a=(0,(0,re.R_)().getIsI2tWorkflow)(),i=(0,m.x)(),c=(0,D.mT)(r),s=(0,ee.et)(r),d=(0,D.n$)(r),p=(0,l.useState)(""),f=p[0],v=p[1];(0,l.useEffect)((function(){a&&1===n&&function(){var e=(0,u.Z)(o().mark((function e(){var t,n,r,a,u,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,J.FG)(i,c,s.userId,d);case 2:return u=e.sent,l=u.data,e.abrupt("return",null===l||void 0===l||null===(t=l.individualToTeamUpgradeOffers)||void 0===t||null===(n=t.activeOffersResult[0])||void 0===n||null===(r=n.offer)||void 0===r||null===(a=r.offerContent)||void 0===a?void 0:a.productName);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()().then(v)}),[]);var y={existingPlansCount:n,refundAmount:t,onLearnMoreClick:function(e){return(0,te.Yo)(e)}};a&&(y=ue(ue({},y),{},{cancellingProductName:f,commitmentTerm:ne.RecurrenceTerm.YEAR}));var g=(0,B.useContentEntry)(X);return ae(l.Fragment,null,ae(B.ContentEntryProvider,{value:function(e){return{title:e.get("title"),learnMoreText:e.get("learnMoreText"),learnMoreLink:e.get("learnMoreLink"),allTerms:a?e.get("newAllTerms"):e.get("allTerms")}}(g),model:K.UC},ae(K._x,y)))})),ce=n(298),se=n(28479),de=n(96029),pe=n(98916),fe=n(23239),ve=n(94797),ye=n(67348),me=n(86695),ge=n(57663),Ce=n(76202),Te=n(24531),he=n(59318),Oe=n(7853),Ee=n(54536),Pe=n(73814),Ae=(0,B.defineContents)("paypaloverlay",{continueButtonLabel:{id:"continueButtonLabel",type:"string",placeholderContent:"Continue (PH)"},cancelButtonLabel:{id:"cancelButtonLabel",type:"string",placeholderContent:"Cancel (PH)"},continueMessage:{id:"continueMessage",type:"string",placeholderContent:"If you've linked your PayPal account, continue now. (PH)"},cancelMessage:{id:"cancelMessage",type:"string",placeholderContent:"Looking to change to a different payment method? Click cancel to proceed. (PH)"}}),be=n(2385),Se=l.createElement;function _e(){var e=(0,R.Z)(["\n        fragment PaypalRedirectUrl on Order {\n          status\n          paymentInstrument {\n            ... on PaypalPaymentInstrument {\n              redirectUrl\n            }\n          }\n        }\n      "]);return _e=function(){return e},e}var Ie,Re=5e3,Ne=2e3,we=3e5;function Le(e,t){return ke.apply(this,arguments)}function ke(){return(ke=(0,u.Z)(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=xe(t,n),e.abrupt("return",n.query({query:Oe.A,variables:{token:r},fetchPolicy:"network-only"}).then((function(e){return e.data.paypalTransaction})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e,t){if(!Ie){var n=t.readFragment({id:"Order:".concat(e),fragment:(0,N.Ps)(_e())}).paymentInstrument.redirectUrl,r=(0,te.rz)(n).token;Ie=r}return Ie}var De,Ue=(0,M.n)("paypaloverlay",Ae)((function(e){var t=e.show,n=void 0!==t&&t,r=e.orderId,a=e.onPaypalSync,i=e.onCancel,c=(0,B.useContentEntry)(Ae),s=(0,l.useState)(!1),d=s[0],p=s[1],f=(0,m.x)();return(0,l.useEffect)((function(){var e,t=[];function l(){return c.apply(this,arguments)}function c(){return(c=(0,u.Z)(o().mark((function t(){var n,u,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Le(r,f);case 2:if(n=t.sent,u=(new Date).getTime(),c=u-e,!(n.status===be.c0.Unknown&&c<we)){t.next=12;break}return t.next=8,new Promise((function(e){return d(e,Ne)}));case 8:return t.next=10,l();case 10:t.next=13;break;case 12:n.status===be.c0.Accepted||n.status===be.c0.Canceled?n.status===be.c0.Accepted?a():i():c>=we&&p(!0);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function s(){return(s=(0,u.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(e){return d(e,Re)}));case 2:e=(new Date).getTime(),p(!1),l();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function d(e,n){t.push(setTimeout(e,n))}n?function(){s.apply(this,arguments)}():(!function(){for(var e=t.pop();e;)clearTimeout(e),e=t.pop()}(),Ie=void 0)}),[n,a,i,f,r]),n&&Se("div",{className:Te.Z.overlay},Se("div",{className:Te.Z.center},d?Se(Ee.f,{"data-testid":"paypal-overlay-info-icon",className:Te.Z.paypalLogo,size:"L"}):Se(he.default,{"data-testid":"paypal-overlay-wait",size:"M"}),Se(Pe.v,{"data-testid":"paypal-logo",className:Te.Z.paypalLogo,size:"Original"}),Se("p",{className:Te.Z.message},c.get(Ae.continueMessage)),Se("p",{className:Te.Z.messageCancel},c.get(Ae.cancelMessage)),Se("div",{className:Te.Z.actionsContainer},Se(Ce.default,{role:"button",variant:"overBackground",className:Te.Z.actionButton,onClick:i,"data-testid":"paypal-overlay-cancel"},c.get(Ae.cancelButtonLabel)),Se(Ce.default,{role:"button",variant:"overBackground",className:Te.Z.actionButton,onClick:a,"data-testid":"paypal-overlay-continue"},c.get(Ae.continueButtonLabel)))))})),Fe=n(13403),Me=n(47626),Ze=l.createElement,je=n(40705),Be=n(52176),We=n(97872);function Ye(e){return e.code===fe.ir.INVALID_CONCESSION}function He(){return{type:k.NI.FORM,code:De.FORM_NON_FATAL_ERROR,extensions:{silent:!0}}}!function(e){e.FORM_NON_FATAL_ERROR="WALLET:FORM_NON_FATAL_ERROR",e.TOKENIZER_SUBMISSION_FAILURE_NON_FATAL_ERROR="WALLET:TOKENIZER_SUBMISSION_FAILURE_NON_FATAL_ERROR",e.TOKENIZER_LOAD_FAILURE_NON_FATAL_ERROR="WALLET:TOKENIZER_LOAD_FAILURE_NON_FATAL_ERROR",e.TOKENIZER_LOAD_SECOND_FAILURE_NON_FATAL_ERROR="WALLET:TOKENIZER_LOAD_SECOND_FAILURE_NON_FATAL_ERROR",e.UNSELECTED_PAYMENT_METHOD_NON_FATAL_ERROR="WALLET:UNSELECTED_PAYMENT_METHOD_NON_FATAL_ERROR"}(De||(De={}));var qe,Ge=n(30137),Ve=n(8703),Ke=n(36015),ze=n(50778),$e=n(59180),Qe=n(2071),Xe=n(96445);!function(e){e.TRIAL="TRIAL",e.BUY="BUY"}(qe||(qe={}));var Je=(0,B.defineContents)("SwitchPlansPaymentContent",{spintName:{id:"spintName",type:"string"},savedWallet:{id:"savedWallet",type:"boolean"},offerType:{id:"offerType",type:"string"},pageTitle:{id:"pageTitle",type:Xe.Ho}}),et=(0,B.defineContents)("PaymentPageContent",{headerAuthUser:{id:"headerAuthUser",type:"string",placeholderContent:"Signed in as"},headerUnauthUser:{id:"headerUnauthUser",type:"string",placeholderContent:"Your new account login"},stepIndicator:{id:"stepIndicator",type:"string"},pageTitle:{id:"pageTitle",type:"string",placeholderContent:"Enter Payment Info \u2014 no charges till trial ends"},pageTitleBuy:{id:"pageTitleBuy",type:"string",placeholderContent:"Enter your payment information."},pageTitleWalletTrial:{id:"pageTitleWalletTrial",type:"string",placeholderContent:"Review payment info to start your free trial"},pageTitleNoWalletTrial:{id:"pageTitleNoWalletTrial",type:"string",placeholderContent:"Enter payment info to start your free trial"},pageTitleWalletBuy:{id:"pageTitleWalletBuy",type:"string",placeholderContent:"Review payment info to start your subscription"},pageTitleNoWalletBuy:{id:"pageTitleNoWalletBuy",type:"string",placeholderContent:"Enter payment info to start your subscription"},pageTitleTeamUpgrade:{id:"pageTitleTeamUpgrade",type:"string",placeholderContent:"Review your upgrade and payment info"},pageSubtitleTeamUpgrade:{id:"pageSubtitleTeamUpgrade",type:"string",placeholderContent:"You can also add more products for your team members."},pageTitleAuthUser:{id:"pageTitleAuthUser",type:"string",placeholderContent:"Welcome back {firstName}! Review your payment info."},changeLabel:{id:"changeLabel",type:"string",placeholderContent:"Change"},buttonContinue:{id:"buttonContinue",type:"string",placeholderContent:"Continue"},buttonBack:{id:"buttonBack",type:"string",placeholderContent:"Back"},buttonPlaceOrder:{id:"buttonPlaceOrder",type:"string",placeholderContent:"Place secure order"},buttonStartTrial:{id:"buttonStartTrial",type:"string",placeholderContent:"Start free trial"},buttonAgreeAndSubscribe:{id:"buttonAgreeAndSubscribe",type:"string",placeholderContent:"Agree and subscribe"},buttonGoToPaypal:{id:"buttonGoToPaypal",type:"string",placeholderContent:"Continue with PayPal"},descriptionGoToPaypal:{id:"descriptionGoToPaypal",type:"string",placeholderContent:"Once your PapPal is connected, you'll be brought back here."},descriptionGoToPaypalInApp:{id:"descriptionGoToPaypalInApp",type:z.RichTextContent.JSON,placeholderContent:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"You'll be sent to your browser to sign in with PayPal.",format:{variants:["bold"]}},{nodeType:"text",value:" Come back here to complete your purchase."}]}]}},buttonContinueToVerification:{id:"buttonContinueToVerification",type:"string",placeholderContent:"Continue to verification"},switchPlans:{id:"switchPlans",type:Je,isArray:!0,placeholderContent:[{spintName:"restart",savedWallet:null,offerType:qe.TRIAL,pageTitle:{plaintext:"(PH) Review payment info to restart your free trial"}},{spintName:"restart",savedWallet:null,offerType:qe.BUY,pageTitle:{plaintext:"(PH) Review payment info to restart your subscription"}},{spintName:"freeToPaid",savedWallet:null,offerType:qe.BUY,pageTitle:{plaintext:"(PH) Review payment info to upgrade your subscription"}},{spintName:"crossSell",savedWallet:null,offerType:qe.TRIAL,pageTitle:{plaintext:"(PH) Review payment info to start your free trial"}},{spintName:"crossSell",savedWallet:null,offerType:qe.BUY,pageTitle:{plaintext:"(PH) Review payment info to start your subscription"}}]}}),tt=n(37020),nt=n(83801),rt=n(14793),ot=n(26268),at=n(6056),it=n(73113),ut=l.createElement;function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var st=(0,it.withDialog)(rt.SW,{onClick:function(e){var t=e.target;return t.className&&t.className.includes("payment-terms-link")}})((function(e){var t=(0,F.useSelector)(D.E6),n=(0,at.Q5)().setBillingStateCode,r=e.billingStateCode,o=e.termsOfUseProps;(0,l.useEffect)((function(){n(r)}),[r,n]);var a=(0,m.x)(),i=(0,F.useStore)(),u=(0,F.useSelector)(E.Zw),c=function(t){var n;null===e||void 0===e||null===(n=e.onClick)||void 0===n||n.call(e,{target:t.target,client:a,store:i})},s={data:ct(ct({},e.data),{},{isTaxInclusive:u}),options:{priceOptions:{styles:{priceFullDisplay:tt.Z.paymentTermsPrice}}}};return ut(l.Fragment,null,ut("div",{role:"button","aria-describedby":"terms-of-use-disclaimer-text",onKeyDown:function(e){rt.Ob.includes(e.key)&&c(e)},onClick:c},ut(ot.u,{termsOfUseProps:o,explicitRenewalConfig:t}),ut(nt.Kd,s)))})),dt=(0,M.n)("subscriptionTerms",nt.q1)(st),pt=n(22544),ft=n(16359),vt=n(46839),yt=n(57840),mt=n(29680),gt=n(60707),Ct=n(42961),Tt=n(30488),ht=n(52905),Ot=n(23424),Et=n(13995),Pt=n(97501),At=n(5112),bt=n(90162),St=n(57876),_t=n(85475),It=n(83237),Rt=n(62452),Nt=n(90841),wt=n(83005),Lt=n(55988),kt=n(41196),xt=n(64726),Dt=n(96909);function Ut(){var e=(0,R.Z)(["\n  fragment CountryTaxSupported on Country {\n    marketSegmentDetails {\n      marketSegmentId\n      taxSupported\n    }\n  }\n"]);return Ut=function(){return e},e}var Ft=(0,N.Ps)(Ut());var Mt=n(14157),Zt=function(){var e,t,n,r,a,i,c,s,p=(0,F.useStore)(),f=(0,m.x)(),v=(0,F.useSelector)(D.mT),y=(0,F.useSelector)(ye.wr),C=(0,F.useSelector)(ge.l6),T=(0,F.useSelector)(ye.sy),h=(0,F.useSelector)(ye.AK),O=(0,l.useState)(T),P=O[0],A=O[1],b=(0,l.useState)(h),S=b[0],_=b[1],I=(0,F.useSelector)(ye.ds),R=(0,l.useState)(I),N=R[0],w=R[1],L=(0,l.useState)(y),k=L[0],x=L[1],U=function(e,t){var n,r=e.readFragment({id:"Country:".concat(t),fragment:Ft}).marketSegmentDetails,o=null===r||void 0===r?void 0:r.find((function(e){return e.marketSegmentId===be.ii.Com}));return null!==(n=null===o||void 0===o?void 0:o.taxSupported)&&void 0!==n&&n}(f,v),M=(0,g.vM)().setError,Z=(0,Pt.g)(),j=null!==(e=null===Z||void 0===Z||null===(t=Z.data)||void 0===t||null===(n=t.order)||void 0===n||null===(r=n.billingAddress)||void 0===r?void 0:r.postalCode)&&void 0!==e?e:"",B=null!==(a=null===Z||void 0===Z||null===(i=Z.data)||void 0===i||null===(c=i.order)||void 0===c||null===(s=c.billingContact)||void 0===s?void 0:s.taxId)&&void 0!==a?a:"",W=(0,Ot.g)([d.R.UC_I2T_FAST_FOLLOW_MARCH,d.R.UC_APPLE_PAY,d.R.UC_FLEXIBLE_PROMOTIONS,d.R.UC_FLEXIBLE_PROMOTIONS_OVERRIDE]),Y=(0,Mt.k)(),H=(0,F.useSelector)(E.Z6),q=(0,F.useSelector)(E.Ut),G=(0,_t.w)();(0,l.useEffect)((function(){function e(){return(e=(0,u.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,pt.Yz)({store:p,apolloClient:f,features:W,isChangePlan:Y,logger:G,isTrialConversion:H,teamTrialConversionData:q});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),null!==e.t0&&void 0!==e.t0&&null!==(t=e.t0.extensions)&&void 0!==t&&t.orderCode&&M(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}y&&((!U&&(!S&&"ADD_NEW"===h&&T?T!==P:!!(k&&y&&k===y&&T&&!P&&j&&T===j)||T!==P&&T!==j)||U&&I!==N&&I!==B||"ADD_NEW"===S&&"WALLET"===h||k&&y!==k&&!C)&&function(){e.apply(this,arguments)}(),A(T),w(I),_(h),x(y))}),[f,p,T,y,I,U,C,M,j,B,k,N,P,S,h,W,Y,G,H,q])},jt=n(52007),Bt=n(21346),Wt=n(6817),Yt=n(93633),Ht=n(46579),qt=n(87835),Gt=n(11367),Vt=n(47578),Kt=n(88882);function zt(){var e=(0,R.Z)(["\n  query GET_WALLET_PROP_DATA($country: ID!, $isAuthenticated: Boolean!) {\n    country(id: $country) {\n      ...paymentCountryInfo\n    }\n    user @include(if: $isAuthenticated) {\n      ...WalletFragment\n    }\n  }\n  ","\n  ","\n"]);return zt=function(){return e},e}function $t(){var e=(0,R.Z)(["\n  query GET_IMS_COUNTRIES($locale: String!) {\n    imsSupportedCountries(locale: $locale) {\n      countryCode\n      countryName\n    }\n  }\n"]);return $t=function(){return e},e}var Qt=(0,N.Ps)($t()),Xt=(0,N.Ps)(zt(),Vt.q,Kt.a),Jt=n(20544),en=n(41681),tn=n(77081),nn=(0,B.defineContents)("PaymentMethod",{paymentMethod:{id:"paymentMethod",type:"string"}}),rn=(0,B.defineContents)("PaymentMethodsOverride",{initialPaymentFormType:{id:"initialPaymentFormType",type:"string"},removedPaymentFormTypes:{id:"removedPaymentFormTypes",type:"string",isArray:!0},orderedPaymentFormTypes:{id:"orderedPaymentFormTypes",type:nn,isArray:!0}}),on=(0,B.defineContents)("PaymentFormField",{fieldName:{id:"fieldName",type:"string"}}),an=(0,B.defineContents)("PaymentFieldsOverride",{countries:{id:"countries",type:"string",isArray:!0},formType:{id:"formType",type:"string"},displayOrder:{id:"displayOrder",type:on,isArray:!0},requiredFields:{id:"requiredFields",type:on,isArray:!0}}),un=(0,B.defineContents)("PaymentFieldOverrideList",{overrides:{id:"overrides",type:an,isArray:!0}}),ln=n(63418),cn=n(89106);function sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pn="wallet",fn="Tokenizer UI Load Failure";function vn(e){return!(null!==e&&void 0!==e&&e.country)}function yn(e,t){var n=(0,cn.G)(),r=(0,a.Z)(n,1)[0],o=(0,kt.$U)(),u=(0,Lt.t)().currentRoute,c=(0,g.vM)().setError,d=(0,F.useSelector)(ye.s$),p=(0,F.useSelector)(de.vl),f=(0,_t.w)();(0,l.useEffect)((function(){if(d===Ht.nY.TokenizerConnectionStatus.ERROR)if(e.current.disablePaymentForm(!0),p[s().app.TOKENIZER_LOAD_FAILURE.name])c(function(e,t){return{type:k.NI.NON_FATAL,code:De.TOKENIZER_LOAD_SECOND_FAILURE_NON_FATAL_ERROR,extensions:{contentVariables:{orderNumber:e,salesPhoneNumber:t}}}}(t,o)),f.error({label:pn,message:"Wallet Tokenizer failed to load more than once"},fn);else{var n=(0,i.Z)({},s().app.TOKENIZER_LOAD_FAILURE.name,1),a=dn(dn({},p),n);r(n,void 0);var l=(0,te.mr)((0,te.Yj)(u),a);c((v=l,{type:k.NI.NON_FATAL,code:De.TOKENIZER_LOAD_FAILURE_NON_FATAL_ERROR,extensions:{contentVariables:{tryAgainUrl:v}}})),f.error({label:pn,message:"Wallet Tokenizer failed to load once"},fn)}var v}),[u,f,t,o,c,r,e,d])}var mn=n(38347),gn=n(61879),Cn=n(28140),Tn=n(75467),hn=n(85266),On=(0,B.defineContents)("switchPaymentCountry",{switchCountryMessageDialog:{id:"switchCountryMessageDialog",type:hn.l,placeholderContent:{title:"This page is about to refresh.",titleHybridWorkflow:"You will be redirected to your web browser.",iconAriaLabel:"Information Dialog",message:{json:[{nodeType:"paragraph",content:[{nodeType:"text",value:"We're about to update this page to show you appropriate payment methods, pricing and country for your selection. Any entered info will be lost."}]}]},confirmLabel:"Change to {newCountryDisplayName}",cancelLabel:"Continue with {currentCountryDisplayName}"}}}),En=n(66482),Pn=l.createElement,An=(0,En.c)("checkout/switchPaymentCountry",On.__contentType,On)((function(e){var t=e.country,n=e.countries,r=e.control,o=e.onConfirm,a=e.onClose,i=(0,B.useContentEntry)(On),u=i.get(On.switchCountryMessageDialog),c=(0,jt.useTrackEvent)(),s=(0,l.useMemo)((function(){return(null===n||void 0===n?void 0:n.reduce((function(e,t){return e[t.countryCode]=t.countryName,e}),{}))||{}}),[n]),d=r[0];r[2]&&(u.title=u.titleHybridWorkflow);var p={newCountryDisplayName:s[d],currentCountryDisplayName:s[t]};return Pn(Tn.n,{variant:"confirmation",onClose:function(){var e=(0,ce.W6)("".concat(V.ps.COUNTRY_CHANGE,":").concat(V.ps.CONTINUE_LINK,":").concat(V.ps.CLICK),V.ps.CONTINUE_LINK);c(e),a()},onConfirm:function(){var e=(0,ce.W6)("".concat(V.ps.CHANGE_COUNTRY,":").concat(V.ps.CLICK),V.ps.CHANGE_COUNTRY);c(e),o.apply(void 0,(0,Cn.Z)(r))},content:hn.l.createEntry(u,i.locale),variables:p})})),bn=n(47995),Sn=l.createElement,_n=l.createElement;function In(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?In(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):In(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nn=(0,M.n)("walletContentTypes",Ht.wL.WalletContentTypes)((function(e){var t,n,r,o,a,u,c,p,f,v=e.walletRef,y=e.submitCallback,C=e.onChangePayPalAccountCallback,T=e.orderData,h=e.isPaypalReturn,O=(0,B.useContentEntry)(rn,!0),P=(0,B.useContentEntry)(un,!0),A=(0,oe.useStore)(),b=(0,oe.useSelector)(D.wJ),_=(0,oe.useSelector)(tn.Gg).clientSessionId,I=(0,oe.useSelector)(ee.et).email,R=(0,oe.useSelector)(D.mT),N=(0,oe.useSelector)(D.Im),w=(0,oe.useSelector)(de.vl),L=(0,oe.useSelector)(ee.PQ),k=(0,oe.useSelector)(ee.hP),x=(0,oe.useSelector)(ee.OQ),F=(0,oe.useSelector)(D.v7),M=(0,oe.useSelector)(D.eE),Z=(0,oe.useSelector)(ye.UN),j=(0,oe.useSelector)(ye.AK),W=(0,oe.useSelector)(ye.UX),H=w[s().app.CTX.name],q=(0,en.$M)(H),G=(0,Rt.KW)(),K=(0,m.x)(),z=(0,oe.useSelector)(E.Jm),$=(t={},(0,i.Z)(t,be.op.Individual,Ht.nY.CustomerSegment.INDIVIDUAL),(0,i.Z)(t,be.op.Team,Ht.nY.CustomerSegment.TEAMS),t),Q=K.readFragment({id:"PersonalizedOffer:".concat($e.xb.COMMITMENT_VARIANTS,":").concat(z),fragment:se.lP}).offer,X=null===Q||void 0===Q?void 0:Q.customerSegment,J=(0,g.jK)(),te=(0,Ot.g)([d.R.UC_WALLET_ACCORDION]),ne=(0,Dt.W)(),re=ne.showApplePay,ae=ne.showGooglePay,ie=(0,ln.l)(),ue=(0,oe.useSelector)(ye.Po);(0,U.pS)(ue,He),yn(v,null===T||void 0===T?void 0:T.orderNumber);var le=(0,Yt.a)(Qt,{ssr:!1,variables:{locale:N}}).data,pe=[{countryCode:R,countryName:R}],fe=L?{headers:{Authorization:k}}:{},me=(0,Yt.a)(Xt,{variables:{country:R,isAuthenticated:L},context:Rn({},fe)}),ge=me.data,Ce=me.loading,Te=me.error,he=me.updateQuery,Oe=me.refetch,Ee=me.previousData;Ce&&(ge=Ee);var Pe=function(e,t,n,r){var o=(0,g.vM)().setError;return(0,l.useEffect)((function(){e&&vn(t)&&o((0,ve.cs)())}),[r,o,n,t,e]),vn(t)}(Te,ge,he,Oe),Ae=h?Ht.nY.PaymentFormType.PAYPAL:W,Se=null===T||void 0===T?void 0:T.paymentInstrument,_e=null!==(n=null===Se||void 0===Se?void 0:Se.paypalEmail)&&void 0!==n?n:void 0,Ie=Z||{},Re=Rn(Rn({},Ie),{},{payerId:h?_e:void 0}),Ne=null===T||void 0===T||null===(r=T.billingContact)||void 0===r?void 0:r.primaryPhone,we=Ie.phoneNumber,Le=Ne&&h&&!we?Ne:void 0;Le&&(Re.phoneNumber=Le);var ke,xe=null===T||void 0===T||null===(o=T.billingContact)||void 0===o?void 0:o.taxId,De=(0,oe.useSelector)(ee.FD),Ue=(0,oe.useSelector)(ye.ds),Fe=null===T||void 0===T?void 0:T.statusHint,Me=function(e,t,n,r,o){var a=!1;if(e&&!n)return(o&&!r||r&&t===Be.k.TAX_ID_CORRECTED&&e!==r)&&(a=!0),a};De?ke=De:Me(xe,Fe,De,Ue,h)&&(ke=xe),ke&&(Re.taxId=ke);var Ze=(0,l.useState)(!!De),We=Ze[0],qe=Ze[1],Ge="ADD_NEW"===j||h,Ve=(0,l.useCallback)((function(){var e;null===v||void 0===v||null===(e=v.current)||void 0===e||e.reloadWalletFormProps()}),[v]),Ke=(0,l.useRef)(De);(0,l.useEffect)((function(){De&&De!==Ke.current&&(qe(!0),Ve(),Ke.current=De)}),[Ve,De]),(0,l.useEffect)((function(){Me(xe,Fe,De,Ue,h)&&Ve()}),[h,xe,Ve,Fe,De,Ue]),(0,l.useEffect)((function(){ie&&Ve()}),[ie,Ve]);var ze=(0,l.useRef)(W),Qe=(0,g.vM)().dismissError;(0,l.useEffect)((function(){W&&W!==ze.current&&(ze.current=W,J&&J.type!==Gt.N.FATAL&&!Ye(J)&&Qe())}),[W,J,Qe]);var Xe=(0,l.useRef)(ae),Je=(0,l.useRef)(re);(0,l.useEffect)((function(){ae===Xe.current&&re===Je.current||(Xe.current=ae,Je.current=re,Ve())}),[re,Je,ae,Xe,Ve]);var et=(0,l.useRef)(h);(0,l.useEffect)((function(){h!==et.current&&(Ve(),et.current=h)}),[h,Ve]);var tt=(0,l.useRef)(_e);(0,l.useEffect)((function(){_e!==tt.current&&(Ve(),tt.current=_e)}),[_e,Ve]);var nt=null===T||void 0===T?void 0:T.paymentInstrument,rt=null===nt||void 0===nt?void 0:nt.mandateId,ot=(0,l.useRef)(rt);(0,l.useEffect)((function(){rt&&!ot.current?ot.current=rt:rt&&ot.current&&rt!==ot.current&&(Ve(),ot.current=rt)}),[rt,Ve]);var at=(0,l.useRef)(x);(0,l.useEffect)((function(){x!==at.current&&(Ve(),at.current=x)}),[x,Ve]);var it=(0,l.useRef)(le);(0,l.useEffect)((function(){le&&le!==it.current&&(Ve(),it.current=le)}),[le,Ve]);var ut,lt=(0,Tt.useCommerceAppContext)().isInApp,ct=ie,st=[];(re||st.push(Y.DigitalPaymentsTypes.APPLE_PAY),ae||st.push(Y.DigitalPaymentsTypes.GOOGLE_PAY),st.length)&&(ct=null===(ut=ct)||void 0===ut?void 0:ut.map((function(e){var t,n=e.allowedDigitalWallets;return n=null===(t=n)||void 0===t?void 0:t.filter((function(e){return!st.includes(e)})),Rn(Rn({},e),{},{allowedDigitalWallets:n})})));var dt=function(){var e,t,n=O.get(rn.initialPaymentFormType),r=O.get(rn.removedPaymentFormTypes),o=null===(e=O.get(rn.orderedPaymentFormTypes))||void 0===e?void 0:e.map((function(e){return e.paymentMethod}));return(n||r||null!==o&&void 0!==o&&o.length)&&(t={initialPaymentFormType:n,removedPaymentFormTypes:r,orderedPaymentFormTypes:o}),t},pt=function(){var e=P.get("overrides"),t=null===e||void 0===e?void 0:e.find((function(e){return e.countries.includes(R)&&e.formType===Ae}));if(t){var n=t.countries,r=t.formType,o=t.displayOrder,a=t.requiredFields;return{countries:n,formType:r,displayOrder:ft(o),requiredFields:ft(a)}}},ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return e.fieldName}))},vt=(0,l.useMemo)((function(){return{paymentMethods:dt(),paymentFormFields:pt()}}),[Ae]);(0,l.useEffect)((function(){return Ve()}),[vt.paymentFormFields]);var yt={showAccordionSelector:(0,je.Pl)(A.getState(),te),disableTaxId:We,formFieldData:Re,formType:Ae,mandateId:rt,preserveAddNewFormData:Ge,googlePlacesApiKey:(0,Jt.D)()===qt.T.PRODUCTION?"AIzaSyDMpsaQdxiJnnvp8aLJLi8p11P1LgP2O74":"AIzaSyBi19j61Ro4o2Yb-PVsdKWocpFbccfznAM",submitCallback:y,onChangePayPalAccountCallback:C,config:{userEmail:I,clientSessionId:_,typekitId:b,tokenizer:{clientId:q,tokenizerConnectionTimeout:31e3,currency:null===Q||void 0===Q||null===(a=Q.currency)||void 0===a?void 0:a.code}},country:Ht.nY.SupportedCountry[R],customerSegment:$[X],dataSources:{walletData:null!==(u=null===(c=ge)||void 0===c||null===(p=c.user)||void 0===p?void 0:p.wallet)&&void 0!==u?u:{},validPaymentsData:ct,countryData:null===(f=ge)||void 0===f?void 0:f.country,imsCountriesListData:((null===le||void 0===le?void 0:le.imsSupportedCountries)||pe).filter((function(e){return e.countryCode===R||!(null!==M&&void 0!==M?M:[]).includes(e.countryCode)}))},displayWalletFieldsForm:!0,hideSensitiveInformation:!!lt(),marketSegment:Ht.nY.MarketSegment.COM,lockCountry:!x,maxPaymentSelectorOptions:3,showNewForm:F,override:vt},mt=function(e){var t=e.country,n=e.countries,r=e.ref,o=(0,l.useContext)(B.ContentContext).locale,a=(0,_t.w)(),i=(0,l.useMemo)((function(){return{variables:{locale:"zh-hant"===o?"zh_TW":o},options:{fetchOptions:{logger:a}},usePlaceholderContent:!0}}),[o,a]);return(0,l.useMemo)((function(){return(0,bn.withDialog)((function(e){var r=e.control,o=e.onClose,a=e.onConfirm;return Sn("div",{"data-testid":"switch-payment-country-dialog"},Sn(An,{aem:i,control:r,onClose:o,onConfirm:a,country:t,countries:n}))}),{onCountryFieldChange:!0},!0)((function(e){var t=e.onCountryFieldChange,n=(0,mn.Z)(e,["onCountryFieldChange"]),o=(0,jt.useTrackEvent)();return Sn(gn.i,(0,S.Z)({ref:r,interceptors:{onCountryFieldChange:function(e,n){var r=(0,ce.W6)("".concat(V.ps.COUNTRY_CHANGE,":").concat(V.ps.MODAL),"".concat(V.ps.COUNTRY_CHANGE).concat(V.ps.MODAL));o(r),t(e,n,!1)}}},n))}))}),[r,i,t,n])}({country:R,countries:null===le||void 0===le?void 0:le.imsSupportedCountries,ref:v}),gt=(0,Mt.k)();return!ge||Pe||gt&&!ct?_n(l.Fragment,null):_n("div",{"data-testid":"wallet-container",className:Wt.Z.walletContainer},_n(mt,(0,S.Z)({storeSliceName:ye.x5},yt,{onCountryFieldChange:function(e,t){t(e),G(e)}})))})),wn=(0,M.n)("paymentMethodsOverride",rn)((function(){return null})).queryCollection,Ln=(0,M.n)("paymentFieldOverrideList",un)((function(){return null})).queryCollection;Nn.queryCollection.merge(wn),Nn.queryCollection.merge(Ln);var kn=n(60718),xn=l.createElement,Dn=(0,M.n)("paymentPage",et)((function(){var e,t,n,r,a=(0,Lt.t)().currentRoute,i=(0,jt.useTrackEvent)(),c=(0,l.useRef)(),p=(0,l.useRef)(),S=(0,l.useRef)(),_=(0,l.useRef)(!1),I=(0,_t.w)(),R=(0,Ot.g)([d.R.P_UC_PSD2_FAKE_403_FOR_NON_3DS_ORDER,d.R.UC_APPLE_PAY,d.R.UC_GOOGLE_PAY,d.R.P_UC_GOOGLE_PAY_PSD2_ENROLLMENT_FAILURE,d.R.P_UC_GOOGLE_PAY_PSD2_ENROLLMENT_SUCCESS,d.R.P_UC_GOOGLE_PAY_PSD2_VALIDATION_FAILURE,d.R.P_UC_GOOGLE_PAY_PSD2_VALIDATION_SUCCESS,d.R.UC_FLEXIBLE_PROMOTIONS,d.R.UC_FLEXIBLE_PROMOTIONS_OVERRIDE,d.R.UC_I2T_FAST_FOLLOW_MARCH,d.R.UC_NEW_SYSTEM_CLOSE,d.R.UC_FORCE_PAYMENT_CTA_OPTIMIZATION,d.R.UC_SHOW_JARVIS_CHAT,d.R.UC_TRIAL_ABUSE,d.R.UC_SWITCH_PLANS]),N=(0,re.R_)(),w=N.hasPreviousStep,L=N.goToPreviousStepWithUpdatedItems,x=N.goToNextStepWithUpdatedItems,M=N.getIsAcademicWorkflow,Z=N.getIsI2tWorkflow,K=N.setLoading,z=(0,G.SX)().getDynamicContextId,$=(0,F.useSelector)(E.RL),Q=(0,F.useSelector)(D.n$),X=(0,F.useStore)(),te=X.getState(),oe=(0,F.useDispatch)(),ae=(0,m.x)(),ie=(0,B.useContentEntry)(et),ue=(0,F.useSelector)(E.Jm),Ce=(0,F.useSelector)(E.f7),Te=(0,F.useSelector)(E.OS),he=(0,F.useSelector)(E.qr),Oe=(0,F.useSelector)(ye.SA),Ee=(0,F.useSelector)(ye.s$),Pe=(0,F.useSelector)(D.dm).learnMoreUrl,Ae=(0,F.useSelector)(D.mT),Se=(0,F.useSelector)(ee.PQ),_e=(0,F.useSelector)(ee.et),Ie=_e.firstName,Re=void 0===Ie?"":Ie,Ne=_e.lastName,we=void 0===Ne?"":Ne,Le=Se?ie.get(et.headerAuthUser):ie.get(et.headerUnauthUser),ke=(0,F.useSelector)(E.Zw),He=(0,Rt.sY)(),Xe=(0,Rt.r9)(),tt=(0,de.vl)(te),nt=(0,Rt.eR)(),rt=(0,Tt.useCommerceAppContext)(),ot=rt.isInApp,at=rt.isInIframe,it=(0,D.eX)(X.getState()),ut=(0,Dt.W)(),lt=ut.showApplePay,ct=ut.showGooglePay,st=(0,je.HI)(te,R),Ut=(0,F.useSelector)(de.El)?"".concat(f.Z.separator," ").concat(f.Z.separatorReader):f.Z.separator,Ft=(0,F.useSelector)(de.By)===s().app.LAYOUT.values.SLIM,Mt=ae.readFragment({id:"PersonalizedOffer:".concat($e.xb.COMMITMENT_VARIANTS,":").concat(ue),fragment:se.lP}).offer,Wt=(0,g.vM)(),Yt=Wt.setError,qt=Wt.dismissError,Gt=(0,U.uk)(),Vt=Gt.setError,Kt=Gt.dismissError,zt=(0,g.jK)(),$t=(0,Pt.g)().data,Qt=(0,Et.z)().getBaseOffers,Xt=(0,Et.K)().swapTrialWithBaseOffers,Jt=(0,bt.D)(),en=null===$t||void 0===$t?void 0:$t.order,tn=null===en||void 0===en?void 0:en.statusHint,nn=(0,F.useSelector)(ye.Qd),rn=(0,l.useState)(!1),on=rn[0],an=rn[1],un=(0,l.useState)(!1),ln=un[0],cn=un[1],sn=(0,l.useState)(!1),dn=sn[0],pn=sn[1],fn=(0,l.useState)(!1),vn=fn[0],yn=fn[1],mn=(0,l.useState)(!1),gn=mn[0],Cn=mn[1],Tn=(0,U.$F)()||st&&(null===zt||void 0===zt?void 0:zt.code)===De.UNSELECTED_PAYMENT_METHOD_NON_FATAL_ERROR,hn=M(),On=Z(),En=(0,F.useSelector)(E.HU),Pn=(0,F.useSelector)(E.Z6),An=(0,F.useSelector)(E.Ut),bn=(0,ye.ai)(X.getState()),Sn=(0,F.useSelector)(ge.l6),_n=(0,Nt.O)().isPaypalRedirectRequired,In=(0,It.a)().invalidatePaypal,Rn=(0,F.useSelector)(ye.Ve),wn=(0,F.useSelector)(ye.e7),Ln=(0,F.useSelector)(E.IG),Dn=(Ln===Ve.v.TEAM||Ln===Ve.v.TEAM_EDU)&&!Sn,Un=(0,F.useSelector)(E.Z6),Fn=(0,F.useSelector)(E.pL);Un||(Fn=null);var Mn=Ln===Ve.v.TEAM_EDU?Ke.MarketSegment.EDU:Ke.MarketSegment.COM,Zn=(0,P.rR)(),jn=(0,F.useSelector)(me.A),Bn=(0,F.useSelector)(E.NO),Wn=(0,l.useState)(void 0),Yn=Wn[0],Hn=Wn[1],qn=(0,Bt.z)(),Gn=(0,h.VB)(h.yr),Vn=On&&function(e,t){var n=(e||{}).refunds;return n?n.map((function(e){var n=e.currency,r=e.priceWithTax,o=e.usePrecision,a=Number(r),i={data:{price:a,formatString:(null===n||void 0===n?void 0:n.formatString)||t},options:{usePrecision:o,styles:Me.Z}},u=Ze(ne.InlinePrice,i);return a?u:void 0})).filter((function(e){return null!=e})):null}(en,null===Mt||void 0===Mt||null===(e=Mt.currency)||void 0===e?void 0:e.formatString),Kn=On&&(null===(t=tt[s().app.CURRENT_SUBSCRIPTION_IDS.name])||void 0===t?void 0:t.length),zn=(0,mt.l)(),$n=zn.showBanner,Qn=zn.setShowBanner,Xn=(0,St._)(),Jn=Xn.setIsJarvisChatEnabled,er=Xn.setChatMode;(0,l.useEffect)((function(){(R[d.R.UC_SHOW_JARVIS_CHAT]||En)&&(Jn(!0),er(""))}),[En]);var tr=(0,Ct.jD)((0,F.useSelector)(E.V4)),nr=(0,F.useSelector)(E.Kq),rr=(0,xt.Z)(),or=(0,l.useRef)(),ar=(0,Ot.g)([d.R.UC_TRIAL_ABUSE])[d.R.UC_TRIAL_ABUSE],ir=(0,Ot.g)([d.R.UC_TRIAL_ABUSE_FINGERPRINT])[d.R.UC_TRIAL_ABUSE_FINGERPRINT];(0,l.useEffect)((function(){null!==Rn&&void 0!==Rn&&Rn.formType&&(!Sn||!wn&&bn||In({updateQueryParamsInUrl:!0}))}),[In,bn,Sn,wn,Rn]);var ur=function(e){var t,n;return(null===e||void 0===e||null===(t=e.extensions)||void 0===t?void 0:t.orderCode)===Be.k.PAYPAL_COUNTRY_MISMATCH||(null===e||void 0===e||null===(n=e.extensions)||void 0===n?void 0:n.orderCode)===Be.k.PAYPAL_SERVICE_ERROR},lr=!!(0,g.jK)(ur);Zt();var cr=function(e){var t,n=e.extensions;null===(t=c.current)||void 0===t||t.setFieldErrors(function(e){switch(e){case Be.k.ORDER_AUTH_INVALID_IBAN:return We.H8.BANK_ACCOUNT_ERROR;case Be.k.TAX_INVALID_ADDRESS:return We.H8.ADDRESS_ERROR;case Be.k.TAX_ID_INVALID:return We.H8.TAX_ID_ERROR;case Be.k.UNSUPPORTED_PAYMENT_TYPE:return We.H8.CREDIT_CARD_NUMBER_ERROR;default:return We.H8.PAYMENT_FAILURE}}(n.orderCode))},sr=null===en||void 0===en||null===(n=en.paymentInstrument)||void 0===n?void 0:n.paypalEmail;(0,l.useEffect)((function(){return Sn&&!sr?oe((0,ge.sH)(!0)):(!Sn||Sn&&sr)&&oe((0,ge.sH)(!1)),function(){oe((0,ge.sH)(!1))}}),[oe,Sn,sr]),(0,l.useEffect)((function(){var e,t,n;null!==zt&&void 0!==zt&&null!==(e=zt.extensions)&&void 0!==e&&e.orderCode&&!Ye(zt)&&cr(zt);var r=null===(t=c.current)||void 0===t?void 0:t.setFieldErrors;return null===(n=window)||void 0===n||n.addEventListener("popstate",(function(){r&&r(Ht.nY.WalletErrorCode.EMPTY_FIELDS_ERROR)})),function(){var e;null===(e=window)||void 0===e||e.removeEventListener("popstate",(function(){r(Ht.nY.WalletErrorCode.EMPTY_FIELDS_ERROR)}))}}),[]);var dr=(0,l.useCallback)((function(e){Yt(e),K(!1),rr(S)}),[rr,Yt,K]),pr=(0,l.useCallback)((function(e){dr(e)}),[dr]),fr=(0,l.useCallback)((function(){K(!1)}),[K]),vr=(0,l.useCallback)(function(){var e=(0,u.Z)(o().mark((function e(t){var n,r,a,i,u,l,c,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.success,r=t.failure,a=nr===b.e.DOCUMENT?G.Np.SET_PASSWORD_DC:G.Np.SET_PASSWORD_CC,e.next=4,z({items:$,locale:Q,variant:a});case 4:return i=e.sent,u={dynamicContextId:i},e.next=8,(0,P.oN)({apolloClient:ae,country:Ae,logger:I,store:X});case 8:if(e.t0=ir,!e.t0){e.next=13;break}return e.next=12,Jt();case 12:e.t0=e.sent;case 13:return l=e.t0,e.prev=14,e.next=17,(0,pt.Yz)({store:X,apolloClient:ae,cartIdentityInput:u,isPlaceOrder:!0,isChangePlan:On,logger:I,features:R,isTrialConversion:Pn,teamTrialConversionData:An,trialAbuseFingerprint:l});case 17:n(),x(),e.next=25;break;case 21:e.prev=21,e.t1=e.catch(14),(null===(c=(0,P.TW)(ae,Bn))||void 0===c?void 0:c.status)===be.iF.PendingAuthentication?(n(),Hn(null===jn||void 0===jn?void 0:jn.transactionId),(0,P.g4)(c,Zn,Ce,I)):(null!==e.t1&&void 0!==e.t1&&null!==(s=e.t1.extensions)&&void 0!==s&&s.orderCode&&dr(e.t1),r(e.t1));case 25:case"end":return e.stop()}}),e,null,[[14,21]])})));return function(t){return e.apply(this,arguments)}}(),[ae,nr,Ae,$,R,z,Jt,x,dr,On,ir,Pn,Q,I,Bn,null===jn||void 0===jn?void 0:jn.transactionId,Zn,X,An,Ce]),yr=(0,l.useCallback)(function(){var e=(0,u.Z)(o().mark((function e(t){var n,r,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=X.getState(),!_.current){e.next=3;break}return e.abrupt("return");case 3:return _.current=!0,K(!0),r=nr===b.e.DOCUMENT?G.Np.SET_PASSWORD_DC:G.Np.SET_PASSWORD_CC,e.next=8,z({items:$,locale:Q,variant:r});case 8:if(a=e.sent,e.t0=ir,!e.t0){e.next=14;break}return e.next=13,Jt();case 13:e.t0=e.sent;case 14:return i=e.t0,e.prev=15,e.next=18,(0,pt.Yz)({store:X,apolloClient:ae,cartIdentityInput:{dynamicContextId:a},features:R,isPlaceOrder:!0,logger:I,isChangePlan:On,state:n,isTrialConversion:Pn,teamTrialConversionData:An,trialAbuseFingerprint:i});case 18:x(),e.next=24;break;case 21:e.prev=21,e.t1=e.catch(15),t(e.t1);case 24:return e.prev=24,_.current=!1,e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[15,21,24,27]])})));return function(t){return e.apply(this,arguments)}}(),[ae,nr,$,z,x,Q,I,X]);function mr(){var e,t=X.getState(),n=(0,ye.l)(t),r=(0,ye.DR)(t);if(n&&!hn)null===(e=or.current)||void 0===e||e.initDigitalPayment({paymentType:Y.DigitalPaymentsTypes.APPLE_PAY});else if(r&&!hn){var o;null===(o=or.current)||void 0===o||o.initDigitalPayment({paymentType:Y.DigitalPaymentsTypes.GOOGLE_PAY})}c.current.submitForm()}function gr(){Dn?p.current.submitForm():mr()}function Cr(){return(Cr=(0,u.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,ce.W6)("".concat(V.Fp.PAGE_PAYMENT,":").concat(V.ps.BACK,":").concat(V.ps.CLICK),V.ps.BACK),i(t),e.next=4,In();case 4:c.current.setFieldErrors(Ht.nY.WalletErrorCode.EMPTY_FIELDS_ERROR),L();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tr(){return(Tr=(0,u.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,In({updateOrder:!1});case 2:gr();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hr(){return(hr=(0,u.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onClose,cn(!0),e.next=4,In({forceInvalidation:!0,updateOrder:!0,updateQueryParamsInUrl:!0});case 4:n();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Or(){return(Or=(0,u.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onClose,cn(!0),e.next=4,In({updateOrder:!1,updateQueryParamsInUrl:!0});case 4:n(),gr();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Er(){return(Er=(0,u.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,pt.Yz)({store:X,apolloClient:ae,features:R,isPaypalInit:!0,isChangePlan:On,logger:I,isTrialConversion:Pn,teamTrialConversionData:An});case 3:K(!ot()),yn(ot()),He(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),dr(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}(0,l.useEffect)((function(){ln&&(qt(),cn(!1))}),[qt,ln]),(0,l.useEffect)((function(){var e=Sn&&tn&&tn!==Be.k.INVALID_CONCESSION;!lr&&e&&dr((0,fe.mA)(tn,X))}),[dr,lr,Sn,tn,X]),(0,l.useEffect)((function(){if(!Sn&&tn&&tn===Be.k.INVALID_CONCESSION){var e=!!tt[s().app.APPLIED_PROMOTION_CODE.name],t=(0,fe.N2)(X,Be.k.INVALID_CONCESSION,R);e&&Yt(t)}}),[Sn,tn]),(0,l.useEffect)((function(){!1===(null===Oe||void 0===Oe?void 0:Oe.status)&&dn&&(Yt(function(e){return{type:k.NI.NON_FATAL,code:De.TOKENIZER_SUBMISSION_FAILURE_NON_FATAL_ERROR,extensions:{contentVariables:{learnMoreUrl:e}}}}(Pe)),c.current.setFieldErrors(Ht.nY.WalletErrorCode.PAYMENT_FAILURE),rr(S))}),[rr,Oe,dn,Pe]),(0,l.useEffect)((function(){Tn&&(dn&&rr(S),pn(!1))}),[Tn,dn,rr]),(0,l.useEffect)((function(){var e=X.getState();function t(){return(t=(0,u.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,P.oN)({apolloClient:ae,country:Ae,logger:I,store:X,storeState:t});case 2:yr((function(e){var t,n=null===e||void 0===e||null===(t=e.extensions)||void 0===t?void 0:t.orderCode,r=(0,P.TW)(ae,Bn);(null===r||void 0===r?void 0:r.status)===be.iF.PendingAuthentication?(Hn(null===jn||void 0===jn?void 0:jn.transactionId),(0,P.g4)(r,Zn,Ce,I)):(dr(e),ar?n!==Be.k.TRIAL_INELIGIBLE&&cr(e):Xe(n)?Cn(!0):cr(e))}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if((0,ye.Qd)(e)&&on){qt(),an(!1);var n,r=!hn;if(((0,ye.l)(e)||(0,ye.DR)(e))&&r)null===(n=or.current)||void 0===n||n.beginDigitalPayment();else r?function(e){t.apply(this,arguments)}(e):x()}!1===(null===Oe||void 0===Oe?void 0:Oe.status)&&on&&(an(!1),K(!1))}),[ae,Ae,qt,$,R,z,x,dr,hn,Q,I,Bn,null===jn||void 0===jn?void 0:jn.transactionId,Zn,Xe,X,K,on,Oe,Ce,nn,On,yr,ar,null===Mt||void 0===Mt||null===(r=Mt.productArrangement)||void 0===r?void 0:r.code,null===Mt||void 0===Mt?void 0:Mt.id,tr]),(0,l.useEffect)((function(){null!==jn&&void 0!==jn&&jn.transactionId&&void 0!==Yn&&Yn!==(null===jn||void 0===jn?void 0:jn.transactionId)&&yr((function(e){dr(e)}))}),[Yn,dr,yr,null===jn||void 0===jn?void 0:jn.transactionId,K]);var Pr=!On&&(!ot()&&!at()||at()&&Ft||ot()&&it&&!Se),Ar=function(){if(ot()){var e=ie.get(et.descriptionGoToPaypalInApp);return xn(W.d,{dataTestId:"in-app-paypal-cta-desc",json:e.json})}var t=ie.get(et.descriptionGoToPaypal);return xn(l.Fragment,null,t)},br=function(e){return(e.search(Je)||[]).filter((function(e){return function(e){var t;return(null!==(t=e.get(Je.spintName))&&void 0!==t?t:"")===tt[s().app.SWITCH_PLANS.name]}(e)&&function(e){var t,n;return(null!==(t=e.get(Je.offerType))&&void 0!==t?t:"")===qe.BUY&&Mt.offerType!==J.m_.Trial||(null!==(n=e.get(Je.offerType))&&void 0!==n?n:"")===Mt.offerType}(e)}))[0]},Sr=function(){return _n?ie.get(et.buttonGoToPaypal):hn?ie.get(et.buttonContinueToVerification):Ce&&!y.y.includes(Ae)?ie.get(et.buttonStartTrial):he?ie.get(et.buttonPlaceOrder):ie.get(et.buttonAgreeAndSubscribe)},_r=(0,At.B)(Sr);(0,l.useEffect)((function(){var e=(0,ce.lG)(Mt,!0),t=(0,ce.Nf)(Mt,e,te,V.RC.EVENT_STATE_TYPE,void 0,a,lt,ct);qn(t)}),[Mt]);var Ir=(0,ht.T)();(0,l.useEffect)((function(){Ir(q.P.PAGE_LOAD),I.info("Payment Page mounted successfully")}),[]);var Rr=xn(l.Fragment,null,function(){if(_n)return xn("div",{className:f.Z.ctaDescription,"data-testid":"terms-of-use-container"},Ar());if(On){var e,t,n,r,o,a;if(!en||!Mt)return null;var i={price:{price:ke?null===(e=en.cartPrice)||void 0===e?void 0:e.totalWithTax:null===(t=en.cartPrice)||void 0===t?void 0:t.totalWithoutTax,formatString:null===(n=Mt.currency)||void 0===n?void 0:n.formatString,usePrecision:null===(r=Mt.currency)||void 0===r?void 0:r.precision},cancelDate:(0,pe.Sd)(null,null===(o=Mt.cancellationTerm)||void 0===o?void 0:o.termRule),country:Ae,term:Mt.term},u=null===en||void 0===en||null===(a=en.billingAddress)||void 0===a?void 0:a.stateCode;return xn("div",{className:f.Z.paymentTermsContainer},xn(dt,{billingStateCode:u,data:i,termsOfUseProps:_r}))}return hn||he?void 0:xn(gt.N,_r)}(),xn(v.s,{backLabel:ie.get(et.buttonBack),ctaLabel:Sr(),disableCtaButton:Tn||Ee===Ht.nY.TokenizerConnectionStatus.ERROR||!st&&void 0===(null===Rn||void 0===Rn?void 0:Rn.formType),onBackClick:function(){return Cr.apply(this,arguments)},onCtaClick:function(){if(!st||null!==Rn&&void 0!==Rn&&Rn.formType){var e,t;Te?(e=V.ps.VERIFICATION,t="".concat(V.Fp.PAGE_PAYMENT,":").concat(V.ps.VERIFICATION,":").concat(V.ps.CLICK)):Ce?(e=V.ps.START_TRIAL,t="".concat(V.Fp.PAGE_PAYMENT,":").concat(V.ps.START_TRIAL,":").concat(V.ps.CLICK)):(e=V.ps.SUBSCRIBE,t="".concat(V.Fp.PAGE_PAYMENT,":").concat(V.ps.SUBSCRIBE,":").concat(V.ps.CLICK));var n=(0,ce.W6)(t,e);i(n),pn(!0),(0,E.Wt)(!1),gr()}else Yt({type:k.NI.NON_FATAL,code:De.UNSELECTED_PAYMENT_METHOD_NON_FATAL_ERROR})},showBackButton:w()})),Nr={salesPhoneNumber:(0,kt.$U)()};function wr(){Qn(!1);var e=(0,E.fq)(X.getState());(0,ft.yU)(tr,e,ze.K),Kt((0,ve.x5)())}var Lr={licenseInvalidCallback:On?function(){Qn(!0),Vt((0,ve.x5)())}:null,licenseInvalidMaxValue:ze.K},kr=$n?xn((function(){return xn(mt.V,{onClose:wr,ctaClicked:function(){return Jn(!0)},contentVariables:Nr})}),null):null;return(0,l.useEffect)((function(){st&&null!==Rn&&void 0!==Rn&&Rn.formType&&Tn&&qt()}),[st,null===Rn||void 0===Rn?void 0:Rn.formType,Tn,qt]),(0,l.useEffect)((function(){function e(){return(e=(0,u.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qt();case 2:t=e.sent,Xt(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}tn===Be.k.TRIAL_INELIGIBLE&&ar&&function(){e.apply(this,arguments)}()}),[tn,ar,Qt,Xt]),xn("div",{ref:S},xn(C.J,{onPrimaryCtaClicked:function(e){bn&&function(e){hr.apply(this,arguments)}(e)},onSecondaryCtaClicked:function(e){bn&&function(e){Or.apply(this,arguments)}(e)},displayErrorFilter:function(e){return ur(e)}}),ot()&&gn?xn(Ge.b,{workflow:Ve.q.TRIAL_ABUSE}):xn(kn.Ru,{header:kr},xn(kn.uN,null,xn(T.qv,{logMeta:{componentName:"Payment",errorLoadingComponent:"StepIndicator"}},xn(yt.O,null)),xn(T.qv,{logMeta:{componentName:"Payment",errorLoadingComponent:"StepHeader"}},xn(vt.l,{title:function(){var e,t;return tt[s().app.SWITCH_PLANS.name]&&br(ie)&&R[d.R.UC_SWITCH_PLANS]?null===(e=br(ie))||void 0===e||null===(t=e.get(null===Je||void 0===Je?void 0:Je.pageTitle))||void 0===t?void 0:t.plaintext:On?ie.format(et.pageTitleTeamUpgrade):R[d.R.UC_SWITCH_PLANS]?wn?Ce?ie.get(et.pageTitleWalletTrial):ie.get(et.pageTitleWalletBuy):Ce?ie.get(et.pageTitleNoWalletTrial):ie.get(et.pageTitleNoWalletBuy):!R[d.R.UC_SWITCH_PLANS]&&Se?ot()||at()?Ce?ie.get(et.pageTitle):ie.get(et.pageTitleBuy):ie.format(et.pageTitleAuthUser,{firstName:Re,lastName:we}):Ce?ie.get(et.pageTitle):ie.get(et.pageTitleBuy)}(),subtitle:function(){if(On)return ie.get(et.pageSubtitleTeamUpgrade)}()})),xn(kn.hg,null,!st&&Pr&&xn("div",null,xn(wt.n,{title:Le,change:ie.get(et.changeLabel),showChangeLink:!(at()&&Ft)}),xn("div",{className:Ut})),Dn&&xn("div",{className:f.Z.companyInfoContainer},xn(j,{companyInfoRef:p,companyName:Fn,disableCompanyName:Un,marketSegment:Mn,submitCallback:function(){R[d.R.UC_I2T_FAST_FOLLOW_MARCH]?mr():c.current.submitForm()}})),xn("div",null,xn(Nn,{walletRef:c,submitCallback:function(){_n?function(){Er.apply(this,arguments)}():an(!0)},onChangePayPalAccountCallback:function(){return Tr.apply(this,arguments)},orderData:en,isPaypalReturn:Sn})),On&&Vn&&xn("div",{className:f.Z.paymentExistingPlanDetails},xn(le,{existingPlansCount:Kn,refundAmount:Vn})),!Gn&&Rr)),xn(kn.Wh,{sticky:!0},st&&Pr&&xn(wt.n,{title:Le,change:ie.get(et.changeLabel),showChangeLink:!(at()&&Ft),isInDetailPanel:!0}),xn(O.A,{licenseInvalidOption:Lr}),xn(A.J,{offer:Mt})),Gn&&xn("div",{className:f.Z.ctaContainer},Rr)),xn(Qe.l,{paymentAuthRef:Zn}),(lt||ct)&&!hn&&xn(H.w,{onCancel:fr,onSubmit:vr,onError:pr,ref:or}),ot()&&xn(Ue,{show:vn,orderId:Bn,onCancel:function(){var e=(0,ce.W6)("".concat(V.ps.PAYPAL_ACCOUNT_CANCEL,":").concat(V.ps.CLICK),V.ps.PAYPAL_ACCOUNT_CANCEL);yn(!1),i(e)},onPaypalSync:function(){var e=xe(Bn,ae),t=(0,Fe.w)(Bn,e,tt),n=(0,ce.W6)("".concat(V.ps.PAYPAL_ACCOUNT_CONTINUE,":").concat(V.ps.CLICK),V.ps.PAYPAL_ACCOUNT_CONTINUE);i(n),nt(t)}}))})),Un=Dn.queryCollection;Un.merge(kn.Ru.queryCollection),Un.merge(O.A.queryCollection),Un.merge(Nn.queryCollection),Un.merge(A.J.queryCollection),Un.merge(yt.O.queryCollection),Un.merge(gt.N.queryCollection),Un.merge(j.queryCollection),Un.merge(Ue.queryCollection),Un.merge(le.queryCollection),Un.merge(dt.queryCollection),Un.merge(mt.V.queryCollection),Un.merge(H.x.queryCollection);var Fn=n(49644),Mn=n(90325),Zn=n(58886),jn=n(47565),Bn=n(19014),Wn=n(6804),Yn=n(57332),Hn=n(94945),qn=n(46576),Gn=n(59205),Vn=l.createElement;function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $n=function(){return(0,qn.Vk)(),(0,pt.bW)(),Wn.kg.info("Server received I2T Payment Page load request"),Vn(Dn,null)};function Qn(e,t){e.info((0,Mn.W1)(t),"Payment Page Offers Response")}$n.getInitialProps=function(){var e=(0,u.Z)(o().mark((function e(t){var n,r,i,u,l,c,f,v,y,m,g,C,T,h,O,P,A,b,S,_,I,R,N,w,L,k,x,U,F,M,Z,j,B,W,Y,H,q,G,V,K;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.apolloClient,i=t.features,u=void 0===i?[]:i,l=t.res,c=t.store,f=t.pathname,v=t.logger,null===l||void 0===l||!l.writableEnded){e.next=3;break}return e.abrupt("return");case 3:return y=c.getState(),m=(0,D.mT)(y),g=(0,D.n$)(y),C=(0,de.yq)(y),T=(0,ee.et)(y),h=(0,de.i2)(y),O=(0,de.tD)(y),P=(0,ee.PQ)(y),A=(0,de.vl)(y),e.next=14,(0,Zn.C)(y,t.logger);case 14:return b=e.sent,S=(0,jn.jD)(y,u.includes(d.R.UC_FLEXIBLE_PROMOTIONS)),_=null===f||void 0===f?void 0:f.replace(/^\//,""),I=(0,Bn.Xx)(_),R=r.query({query:p.l,variables:(0,p.q)({country:m,locale:g,offerIds:C,userId:T.userId,clientId:h,svar:O,promotionCodes:S,useTestCampaign:u.includes(d.R.P_UC_USE_TEST_CAMPAIGNS)}),context:zn({},b)}),N=r.query({query:se.nk,variables:(0,se.Tq)({country:m}),context:zn({},b)}),w=null===(n=A[s().app.CURRENT_SUBSCRIPTION_IDS.name])||void 0===n?void 0:n.length,L=I&&1===w&&(0,J.FG)(r,m,T.userId,g),e.next=24,Promise.all([R,N,L]);case 24:return k=e.sent,x=(0,a.Z)(k,2),U=x[0],F=x[1],y=c.getState(),P=(0,ee.PQ)(y),e.next=32,(0,Zn.C)(y,t.logger);case 32:if(b=e.sent,!(M=(null===U||void 0===U?void 0:U.errors)||(null===F||void 0===F?void 0:F.errors))){e.next=39;break}return Z={currentRoute:Yn.Z.PAYMENT},e.abrupt("return",{error:(0,ve.S2)(M,r,c,Z)});case 39:if(Y=U.data.commitmentVariantsOffers,H=Y.resolvedSourceOfferIds,q=Y.result,G=(0,Mn.IG)(null===q||void 0===q||null===(j=q[0])||void 0===j||null===(B=j.offers)||void 0===B||null===(W=B[0])||void 0===W?void 0:W.offer),c.dispatch((0,E.fC)(G)),(0,Hn.M)(t,H),null!==q&&void 0!==q&&q.length){e.next=45;break}throw(0,Fn.n)();case 45:return Qn(v,U.data.commitmentVariantsOffers),V=r.query({query:se.N4,context:zn({},b),variables:(0,se.Tj)({country:m,offerIds:H,isAuthenticated:P,isI2T:I})}).catch((function(){return null})),e.next=49,Promise.all([V]);case 49:K=I?Yn.Z.TEAMS_PLAN_PAYMENT:Yn.Z.PAYMENT,(0,re.OK)(t,K,{features:u,stepBackward:!0});case 51:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var Xn=(0,Gn.O)(Dn.queryCollection,Yn.Z.PAYMENT)($n)},75295:function(e,t,n){"use strict";n.d(t,{Y:function(){return f}});var r=n(809),o=n.n(r),a=n(92447),i=n(19529);function u(){return{expiry:Number.MAX_SAFE_INTEGER,tokenPromise:null}}var l=u();function c(e,t){return i.Z.getImsServiceToken(e,t)}function s(){return!l.tokenPromise||Date.now()>l.expiry}function d(e){return Date.now()+1e3*e.expires_in/1.2}function p(){l=u()}function f(){return v.apply(this,arguments)}function v(){return(v=(0,a.Z)(o().mark((function e(){var t,n,r,a,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:{},n=i.length>1?i[1]:void 0,e.prev=2,!s()){e.next=12;break}return l.expiry=Number.MAX_SAFE_INTEGER,l.tokenPromise=c(t,n),e.next=8,l.tokenPromise;case 8:r=e.sent,l.expiry=d(r),e.next=15;break;case 12:return e.next=14,l.tokenPromise;case 14:r=e.sent;case 15:a=r.access_token,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),p();case 21:return e.abrupt("return",a);case 22:case"end":return e.stop()}}),e,null,[[2,18]])})))).apply(this,arguments)}},19529:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(809),o=n.n(r),a=n(92447),i=n(26265),u=n(49675),l=n(47130),c=n(60196);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var d,p=(0,l.Z)(),f=function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.clone().json();case 3:n=e.sent,r=(0,c.oY)(t.url),a=new URLSearchParams(r.params).toString(),i=a?"".concat(r.url,"?").concat(a):"".concat(r.url),n&&d.info({data:n,path:i,status:t.status}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),v={request:function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({agent:p,compress:!0},t);return d=null===t||void 0===t?void 0:t.logger,[e,n]},response:function(e){if(+(null===e||void 0===e?void 0:e.status)>=300)throw d&&f(e),e;return e}},y=n(1375),m=n(10975),g=n(80129);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(){var e=(0,u.Z)(v),t=function(){var e=(0,a.Z)(o().mark((function e(t,r){var a,i,u,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>2&&void 0!==l[2]?l[2]:{},i=l.length>3?l[3]:void 0,(u=T({},(0,y.Zb)(r))).authCode=t,e.abrupt("return",n(u,a,i));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n=function(){var t=(0,a.Z)(o().mark((function t(n){var r,a,i,u=arguments;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:{},a=u.length>2?u[2]:void 0,i={grant_type:"authorization_code",code:n.authCode,client_id:n.clientId,client_secret:n.secret},t.next=5,e.post("".concat(n.domain,"/ims/token/v2?").concat((0,g.stringify)(i)),{headers:T({},r),logger:a});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return T(T({},e),{},{getImsHealthCheck:function(t){var n=(0,y.Ib)();return e.get("".concat(n.domain,"/ims/healthcheck"),{headers:(0,i.Z)({},m.A.name.X_IMS_CLIENTID,n.clientId),timeout:u.L.IMS_HEALTH_CHECK_TIMEOUT,logger:t})},getImsProfileAndToken:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,a=(0,y.Zb)(n);return e.post("".concat(a.domain,"/ims/token/v3"),{body:(0,g.stringify)({grant_type:"aux_sid_exchange",client_id:a.clientId,client_secret:a.secret,aux_sid:t,scope:a.scopes,project_user_profile:!0}),headers:T({"Content-Type":"application/x-www-form-urlencoded"},r),timeout:u.L.SHORT_HTTP_TIMEOUT,logger:o})},getImsAccessToken:t,getImsProfileAndTokenFromImplicitJumpToken:function(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0,i=(0,y.Zb)(r),l={client_id:i.clientId};return e.get("".concat(i.domain,"/ims/jump/implicit/").concat(t,"?").concat((0,g.stringify)(l)),{headers:T({Authorization:"Bearer ".concat(n)},o),timeout:u.L.SHORT_HTTP_TIMEOUT,logger:a},{includeHeaders:!0})},getImsServiceToken:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=(0,y.Ib)();return n(r,e,t)}})}()},19917:function(){},34828:function(){},8777:function(){}}]);